<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" style="background: #ffffff; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); color-scheme: light dark;" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="992px" height="586px" viewBox="0 0 992 586"><defs><pattern patternUnits="userSpaceOnUse" width="11.5" height="11.5" x="0" y="0" patternTransform="rotate(45)" id="mx-pattern-hatch-1-light-dark_e4e4e4_292929_-0"><line x1="0" y1="0" x2="0" y2="11.5" stroke="#e4e4e4" stroke-width="1.5" style="stroke: light-dark(rgb(228, 228, 228), rgb(41, 41, 41));"/></pattern><pattern patternUnits="userSpaceOnUse" width="11.5" height="11.5" x="0" y="0" patternTransform="rotate(45)" id="mx-pattern-hatch-1-light-dark_c4eeec_1c1c1c_-0"><line x1="0" y1="0" x2="0" y2="11.5" stroke="#c4eeec" stroke-width="1.5" style="stroke: light-dark(rgb(196, 238, 236), rgb(28, 28, 28));"/></pattern><pattern patternUnits="userSpaceOnUse" width="11.5" height="11.5" x="0" y="0" patternTransform="rotate(45)" id="mx-pattern-hatch-1-light-dark_d5e8d4_1f2f1e_-0"><line x1="0" y1="0" x2="0" y2="11.5" stroke="#d5e8d4" stroke-width="1.5" style="stroke: light-dark(rgb(213, 232, 212), rgb(31, 47, 30));"/></pattern><pattern patternUnits="userSpaceOnUse" width="11.5" height="11.5" x="0" y="0" patternTransform="rotate(45)" id="mx-pattern-hatch-1-light-dark_dae8fc_1d293b_-0"><line x1="0" y1="0" x2="0" y2="11.5" stroke="#dae8fc" stroke-width="1.5" style="stroke: light-dark(rgb(218, 232, 252), rgb(29, 41, 59));"/></pattern><pattern patternUnits="userSpaceOnUse" width="11.5" height="11.5" x="0" y="0" patternTransform="rotate(45)" id="mx-pattern-hatch-1-light-dark_e1d5e7_392f3f_-0"><line x1="0" y1="0" x2="0" y2="11.5" stroke="#e1d5e7" stroke-width="1.5" style="stroke: light-dark(rgb(225, 213, 231), rgb(57, 47, 63));"/></pattern><pattern patternUnits="userSpaceOnUse" width="11.5" height="11.5" x="0" y="0" patternTransform="rotate(45)" id="mx-pattern-hatch-1-light-dark_f8cecc_512d2b_-0"><line x1="0" y1="0" x2="0" y2="11.5" stroke="#f8cecc" stroke-width="1.5" style="stroke: light-dark(rgb(248, 206, 204), rgb(81, 45, 43));"/></pattern></defs><rect fill="#ffffff" width="100%" height="100%" x="0" y="0" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212));"/><g><g data-cell-id="0"><g data-cell-id="1"><g data-cell-id="9BSo3wNhfy6OWNm6dqiN-4"><g transform="translate(0.5,0.5)"><path d="M 162 492 L 176.63 492" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 181.88 492 L 174.88 495.5 L 176.63 492 L 174.88 488.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="9BSo3wNhfy6OWNm6dqiN-1"><g transform="translate(0.5,0.5)"><rect x="16" y="399" width="146" height="186" rx="21.9" ry="21.9" fill="url(#mx-pattern-hatch-1-light-dark_e4e4e4_292929_-0)" stroke="#8f8f8f" pointer-events="all" style="stroke: light-dark(rgb(143, 143, 143), rgb(114, 114, 114));"/></g></g><g data-cell-id="voEEKS4HxWeX5d6XAF2z-2"><g transform="translate(0.5,0.5)"><path d="M 23 191 L 7.03 191.03 L 7.03 470 L 23.63 470" fill="none" stroke="#020303" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(2, 3, 3), rgb(237, 237, 237));"/><path d="M 28.88 470 L 21.88 473.5 L 23.63 470 L 21.88 466.5 Z" fill="#020303" stroke="#020303" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(2, 3, 3), rgb(237, 237, 237)); stroke: light-dark(rgb(2, 3, 3), rgb(237, 237, 237));"/></g></g><g data-cell-id="Sme6n3pp0KyCIf3mBVLR-1"><g transform="translate(0.5,0.5)"><rect x="23" y="17" width="968" height="348" rx="52.2" ry="52.2" fill-opacity="0.8" fill="url(#mx-pattern-hatch-1-light-dark_c4eeec_1c1c1c_-0)" stroke="#90b7be" stroke-dasharray="8 8" pointer-events="all" style="stroke: light-dark(rgb(144, 183, 190), rgb(114, 114, 114));"/></g></g><g data-cell-id="3s5B7JeaZjeE3N2WEkbi-27"><g transform="translate(0.5,0.5)"><path d="M 529 299 L 500.37 299" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 495.12 299 L 502.12 295.5 L 500.37 299 L 502.12 302.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="3s5B7JeaZjeE3N2WEkbi-13"><g transform="translate(0.5,0.5)"/><g data-cell-id="R7gGAxR2AnRSfAshmNvf-1"><g transform="translate(0.5,0.5)"><rect x="183" y="38" width="780" height="170" rx="25.5" ry="25.5" fill="url(#mx-pattern-hatch-1-light-dark_d5e8d4_1f2f1e_-0)" stroke="#82b366" pointer-events="all" style="stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g></g><g data-cell-id="kzTMP7wht4pQDYGdvjpm-24"><g transform="translate(0.5,0.5)"><path d="M 333 138 L 346.63 138" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 351.88 138 L 344.88 141.5 L 346.63 138 L 344.88 134.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="PguvAPKt5OM3NZjW2cp2-1"><g transform="translate(0.5,0.5)"><rect x="213" y="108" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 138px; margin-left: 214px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Transformer</div></div></div></foreignObject><text x="273" y="142" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Transformer</text></switch></g></g></g><g data-cell-id="3s5B7JeaZjeE3N2WEkbi-17"><g transform="translate(0.5,0.5)"><rect x="206.5" y="22" width="113" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 111px; height: 1px; padding-top: 37px; margin-left: 208px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #82B366; background-color: #ffffff; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: light-dark(#82B366, #FFC8C8); line-height: 1.2; pointer-events: all; font-weight: bold; background-color: light-dark(#ffffff, #ededed); white-space: normal; word-wrap: normal; "><font style="font-size: 16px;">Decoder</font></div></div></div></foreignObject><text x="263" y="41" fill="light-dark(#82B366,#FFC8C8)" font-family="Helvetica" font-size="14px" text-anchor="middle" font-weight="bold">Decoder</text></switch></g></g></g><g data-cell-id="knx2XeJ29bijMbTom-tf-6"><g transform="translate(0.5,0.5)"><rect x="723" y="22" width="233" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 231px; height: 1px; padding-top: 37px; margin-left: 724px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #82B366; background-color: #ffffff; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#82B366, #FFC8C8); line-height: 1.2; pointer-events: all; font-weight: bold; background-color: light-dark(#ffffff, #ededed); white-space: normal; word-wrap: normal; ">Frozen during generation in SCST</div></div></div></foreignObject><text x="840" y="41" fill="light-dark(#82B366,#FFC8C8)" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">Frozen during generation in SCST</text></switch></g></g></g><g data-cell-id="kzTMP7wht4pQDYGdvjpm-25"><g transform="translate(0.5,0.5)"><path d="M 473 138 L 496.63 138" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 501.88 138 L 494.88 141.5 L 496.63 138 L 494.88 134.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="3s5B7JeaZjeE3N2WEkbi-8"><g transform="translate(0.5,0.5)"><rect x="353" y="108" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 138px; margin-left: 354px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Last layer<br />hiddens</div></div></div></foreignObject><text x="413" y="142" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Last layer...</text></switch></g></g></g><g data-cell-id="kzTMP7wht4pQDYGdvjpm-17"><g transform="translate(0.5,0.5)"><rect x="503" y="108" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 138px; margin-left: 504px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Logits</div></div></div></foreignObject><text x="563" y="142" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Logits</text></switch></g></g></g><g data-cell-id="kzTMP7wht4pQDYGdvjpm-18"><g transform="translate(0.5,0.5)"/><g data-cell-id="3s5B7JeaZjeE3N2WEkbi-1"><g transform="translate(0.5,0.5)"><rect x="660.5" y="58" width="260" height="130" rx="19.5" ry="19.5" fill-opacity="0.5" fill="#ffffff" stroke="#82b366" pointer-events="all" style="fill: light-dark(rgb(255, 255, 255), rgb(31, 47, 30)); stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g></g><g data-cell-id="3s5B7JeaZjeE3N2WEkbi-5"><g transform="translate(0.5,0.5)"><rect x="682.5" y="74.5" width="100" height="38.5" rx="5.77" ry="5.77" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 94px; margin-left: 684px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Next-token<br />prediction</div></div></div></foreignObject><text x="733" y="97" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Next-token...</text></switch></g></g></g><g data-cell-id="3s5B7JeaZjeE3N2WEkbi-9"><g transform="translate(0.5,0.5)"><rect x="803" y="74.5" width="100" height="38.5" rx="5.77" ry="5.77" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 94px; margin-left: 804px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">PF-lite</div></div></div></foreignObject><text x="853" y="97" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">PF-lite</text></switch></g></g></g><g data-cell-id="3s5B7JeaZjeE3N2WEkbi-10"><g transform="translate(0.5,0.5)"><rect x="682.5" y="131" width="100" height="42" rx="6.3" ry="6.3" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 152px; margin-left: 684px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Contrastive bar</div></div></div></foreignObject><text x="733" y="156" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Contrastive bar</text></switch></g></g></g><g data-cell-id="3s5B7JeaZjeE3N2WEkbi-18"><g transform="translate(0.5,0.5)"><rect x="671" y="44" width="170" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 59px; margin-left: 672px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #82B366; background-color: #ffffff; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#82B366, #FFC8C8); line-height: 1.2; pointer-events: all; font-weight: bold; background-color: light-dark(#ffffff, #ededed); white-space: normal; word-wrap: normal; "><font>Losses d</font>uring pre-training</div></div></div></foreignObject><text x="756" y="63" fill="light-dark(#82B366,#FFC8C8)" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">Losses during pre-training</text></switch></g></g></g></g><g data-cell-id="kzTMP7wht4pQDYGdvjpm-19"><g transform="translate(0.5,0.5)"><path d="M 660.5 90.5 L 660.48 88 L 272.97 88 L 272.99 101.63" fill="none" stroke="#82b366" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/><path d="M 273 106.88 L 269.49 99.89 L 272.99 101.63 L 276.49 99.88 Z" fill="#82b366" stroke="#82b366" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(130, 179, 102), rgb(68, 110, 44)); stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g></g><g data-cell-id="kzTMP7wht4pQDYGdvjpm-26"><g transform="translate(0.5,0.5)"><path d="M 623 138 L 656.21 138.18" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 661.46 138.2 L 654.44 141.67 L 656.21 138.18 L 654.48 134.67 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g></g><g data-cell-id="kzTMP7wht4pQDYGdvjpm-4"><g transform="translate(0.5,0.5)"><path d="M 152 123 L 176.63 123" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 181.88 123 L 174.88 126.5 L 176.63 123 L 174.88 119.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="3s5B7JeaZjeE3N2WEkbi-14"><g transform="translate(0.5,0.5)"><rect x="32" y="93" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 123px; margin-left: 33px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Prime sequence</div></div></div></foreignObject><text x="92" y="127" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Prime sequence</text></switch></g></g></g><g data-cell-id="kzTMP7wht4pQDYGdvjpm-14"><g transform="translate(0.5,0.5)"/><g data-cell-id="t_AH6ZIH8dnTPtmeXsHa-1"><g transform="translate(0.5,0.5)"><rect x="529" y="249" width="440" height="100" rx="15" ry="15" fill="url(#mx-pattern-hatch-1-light-dark_dae8fc_1d293b_-0)" stroke="#56769b" pointer-events="all" style="stroke: light-dark(rgb(86, 118, 155), rgb(116, 143, 175));"/></g></g><g data-cell-id="3s5B7JeaZjeE3N2WEkbi-22"><g transform="translate(0.5,0.5)"><path d="M 829 299 L 815.37 299" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 810.12 299 L 817.12 295.5 L 815.37 299 L 817.12 302.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="3s5B7JeaZjeE3N2WEkbi-19"><g transform="translate(0.5,0.5)"><rect x="829" y="269" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 299px; margin-left: 830px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Input projection</div></div></div></foreignObject><text x="889" y="303" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Input projection</text></switch></g></g></g><g data-cell-id="3s5B7JeaZjeE3N2WEkbi-20"><g transform="translate(0.5,0.5)"><rect x="689" y="269" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 299px; margin-left: 690px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Transformer</div></div></div></foreignObject><text x="749" y="303" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Transformer</text></switch></g></g></g><g data-cell-id="3s5B7JeaZjeE3N2WEkbi-21"><g transform="translate(0.5,0.5)"><rect x="549" y="269" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 299px; margin-left: 550px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">To logits</div></div></div></foreignObject><text x="609" y="303" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">To logits</text></switch></g></g></g><g data-cell-id="3s5B7JeaZjeE3N2WEkbi-24"><g transform="translate(0.5,0.5)"><path d="M 689 299 L 675.37 299" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 670.12 299 L 677.12 295.5 L 675.37 299 L 677.12 302.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="3s5B7JeaZjeE3N2WEkbi-28"><g transform="translate(0.5,0.5)"><rect x="524" y="232" width="113" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 111px; height: 1px; padding-top: 247px; margin-left: 525px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #56769b; background-color: #ffffff; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: light-dark(#56769b, #FFC8C8); line-height: 1.2; pointer-events: all; font-weight: bold; background-color: light-dark(#ffffff, #ededed); white-space: normal; word-wrap: normal; "><font style="font-size: 16px;">Adapter</font></div></div></div></foreignObject><text x="581" y="251" fill="light-dark(#56769b, #FFC8C8)" font-family="Helvetica" font-size="14px" text-anchor="middle" font-weight="bold">Adapter</text></switch></g></g></g><g data-cell-id="knx2XeJ29bijMbTom-tf-5"><g transform="translate(0.5,0.5)"><rect x="777" y="332" width="214" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 212px; height: 1px; padding-top: 347px; margin-left: 778px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #56769b; background-color: #ffffff; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#56769b, #FFC8C8); line-height: 1.2; pointer-events: all; font-weight: bold; background-color: light-dark(#ffffff, #ededed); white-space: normal; word-wrap: normal; "><font>identity initiliazation</font></div></div></div></foreignObject><text x="884" y="351" fill="light-dark(#56769b, #FFC8C8)" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">identity initiliazation</text></switch></g></g></g></g><g data-cell-id="kzTMP7wht4pQDYGdvjpm-15"><g transform="translate(0.5,0.5)"/><g data-cell-id="3s5B7JeaZjeE3N2WEkbi-25"><g transform="translate(0.5,0.5)"><rect x="184" y="249" width="310" height="100" rx="15" ry="15" fill="url(#mx-pattern-hatch-1-light-dark_e1d5e7_392f3f_-0)" stroke="#9673a6" pointer-events="all" style="stroke: light-dark(rgb(150, 115, 166), rgb(149, 119, 163));"/></g></g><g data-cell-id="knx2XeJ29bijMbTom-tf-1"><g transform="translate(0.5,0.5)"><rect x="354.5" y="269" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 299px; margin-left: 356px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Finite-state<br />machine (FSM)</div></div></div></foreignObject><text x="415" y="303" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Finite-state...</text></switch></g></g></g><g data-cell-id="knx2XeJ29bijMbTom-tf-2"><g transform="translate(0.5,0.5)"><rect x="204" y="269" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 299px; margin-left: 205px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Top-p<br />sampling</div></div></div></foreignObject><text x="264" y="303" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Top-p...</text></switch></g></g></g><g data-cell-id="knx2XeJ29bijMbTom-tf-7"><g transform="translate(0.5,0.5)"><rect x="184" y="232" width="113" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 111px; height: 1px; padding-top: 247px; margin-left: 185px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #9673a6; background-color: #ffffff; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: light-dark(#9673a6, #FFC8C8); line-height: 1.2; pointer-events: all; font-weight: bold; background-color: light-dark(#ffffff, #ededed); white-space: normal; word-wrap: normal; "><font style="font-size: 16px;">Sampler</font></div></div></div></foreignObject><text x="241" y="251" fill="light-dark(#9673a6, #FFC8C8)" font-family="Helvetica" font-size="14px" text-anchor="middle" font-weight="bold">Sampler</text></switch></g></g></g><g data-cell-id="knx2XeJ29bijMbTom-tf-3"><g transform="translate(0.5,0.5)"><path d="M 354.5 299 L 330.37 299" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 325.12 299 L 332.12 295.5 L 330.37 299 L 332.12 302.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g></g><g data-cell-id="kzTMP7wht4pQDYGdvjpm-20"><g transform="translate(0.5,0.5)"><path d="M 413 168 L 412.97 227.03 L 889.03 227.03 L 889.01 262.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="8 8" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 889 267.88 L 885.51 260.88 L 889.01 262.63 L 892.51 260.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="kzTMP7wht4pQDYGdvjpm-21"><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 225px; margin-left: 680px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">During generation</div></div></div></foreignObject><text x="680" y="229" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px" text-anchor="middle">During generation</text></switch></g></g></g></g><g data-cell-id="kzTMP7wht4pQDYGdvjpm-27"><g transform="translate(0.5,0.5)"><path d="M 184 299 L 92 298.97 L 92 159.37" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 92 154.12 L 95.5 161.12 L 92 159.37 L 88.5 161.12 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="kzTMP7wht4pQDYGdvjpm-28"><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 231px; margin-left: 90px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">Append token</div></div></div></foreignObject><text x="90" y="234" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px" text-anchor="middle">Append token</text></switch></g></g></g></g><g data-cell-id="voEEKS4HxWeX5d6XAF2z-1"><g transform="translate(0.5,0.5)"><rect x="64" y="0" width="123" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 121px; height: 1px; padding-top: 15px; margin-left: 65px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #9ec0c6; background-color: #ffffff; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: light-dark(#9ec0c6, #FFC8C8); line-height: 1.2; pointer-events: all; font-weight: bold; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: normal; word-wrap: normal; ">Generation loop</div></div></div></foreignObject><text x="126" y="19" fill="light-dark(#9ec0c6, #FFC8C8)" font-family="Helvetica" font-size="14px" text-anchor="middle" font-weight="bold">Generation loop</text></switch></g></g></g><g data-cell-id="ZrHKWYk25MqRuA0MvCR7-1"><g transform="translate(0.5,0.5)"><rect x="29" y="417" width="120" height="30" rx="4.5" ry="4.5" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 432px; margin-left: 30px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Prime sequence</div></div></div></foreignObject><text x="89" y="436" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Prime sequence</text></switch></g></g></g><g data-cell-id="ZrHKWYk25MqRuA0MvCR7-4"><g transform="translate(0.5,0.5)"><rect x="30" y="455" width="120" height="30" rx="4.5" ry="4.5" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 470px; margin-left: 31px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Gen. continuation</div></div></div></foreignObject><text x="90" y="474" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Gen. continuation</text></switch></g></g></g><g data-cell-id="ZrHKWYk25MqRuA0MvCR7-5"><g transform="translate(0.5,0.5)"><rect x="29" y="495" width="120" height="30" rx="4.5" ry="4.5" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 510px; margin-left: 30px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Real continuation</div></div></div></foreignObject><text x="89" y="514" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Real continuation</text></switch></g></g></g><g data-cell-id="ZrHKWYk25MqRuA0MvCR7-6"><g transform="translate(0.5,0.5)"><rect x="30" y="535" width="120" height="30" rx="4.5" ry="4.5" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 550px; margin-left: 31px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Real mismatched</div></div></div></foreignObject><text x="90" y="554" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Real mismatched</text></switch></g></g></g><g data-cell-id="U0eDsRkNowskEU1cyVyJ-2"><g transform="translate(0.5,0.5)"/><g data-cell-id="WPyM6qacfhTPeJpHIS1Z-5"><g transform="translate(0.5,0.5)"><rect x="183" y="399" width="790" height="186" rx="27.9" ry="27.9" fill="url(#mx-pattern-hatch-1-light-dark_f8cecc_512d2b_-0)" stroke="#b85450" pointer-events="all" style="stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 788px; height: 1px; padding-top: 492px; margin-left: 184px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span style="color: light-dark(rgba(0, 0, 0, 0), rgba(237, 237, 237, 0)); font-family: monospace; font-size: 0px; text-align: start; text-wrap-mode: nowrap;">%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CmxCell%20id%3D%222%22%20parent%3D%221%22%20style%3D%22rounded%3D1%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3BfillColor%3Ddefault%3BstrokeColor%3D%23660000%3BfillStyle%3Dauto%3Bdashed%3D1%3BfillOpacity%3D57%3Bsketch%3D1%3BcurveFitting%3D1%3Bjiggle%3D2%3B%22%20value%3D%22%22%20vertex%3D%221%22%3E%3CmxGeometry%20height%3D%22170%22%20width%3D%22150%22%20x%3D%2279%22%20y%3D%22468%22%20as%3D%22geometry%22%2F%3E%3C%2FmxCell%3E%3C%2Froot%3E%3C%2FmxGraphModel%3E</span></div></div></div></foreignObject><text x="578" y="496" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CmxCell%20id%3D%222%22...</text></switch></g></g></g><g data-cell-id="WPyM6qacfhTPeJpHIS1Z-16"><g transform="translate(0.5,0.5)"><rect x="208" y="379" width="113" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 111px; height: 1px; padding-top: 394px; margin-left: 209px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #b85450; background-color: #ffffff; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: light-dark(#b85450, #ffc8c8); line-height: 1.2; pointer-events: all; font-weight: bold; background-color: light-dark(#ffffff, #ededed); white-space: normal; word-wrap: normal; "><font style="font-size: 16px;">Discriminator</font></div></div></div></foreignObject><text x="265" y="398" fill="light-dark(#b85450, #ffc8c8)" font-family="Helvetica" font-size="14px" text-anchor="middle" font-weight="bold">Discriminator</text></switch></g></g></g><g data-cell-id="ZrHKWYk25MqRuA0MvCR7-17"><g transform="translate(0.5,0.5)"><path d="M 619 444 L 639.03 444 L 635.03 444 L 648.63 444" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 653.88 444 L 646.88 447.5 L 648.63 444 L 646.88 440.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="ZrHKWYk25MqRuA0MvCR7-14"><g transform="translate(0.5,0.5)"><rect x="499" y="414" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 444px; margin-left: 500px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Bar-level<br />head</div></div></div></foreignObject><text x="559" y="448" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Bar-level...</text></switch></g></g></g><g data-cell-id="klyqtZBdWCXgg6U5yR7y-20"><g transform="translate(0.5,0.5)"><path d="M 775 444 L 795.52 444 L 795.52 479.03 L 809.63 479.01" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 814.88 479 L 807.89 482.51 L 809.63 479.01 L 807.88 475.51 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="ZrHKWYk25MqRuA0MvCR7-15"><g transform="translate(0.5,0.5)"><rect x="655" y="414" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 444px; margin-left: 656px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Global<br />pooling</div></div></div></foreignObject><text x="715" y="448" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Global...</text></switch></g></g></g><g data-cell-id="klyqtZBdWCXgg6U5yR7y-8"><g transform="translate(0.5,0.5)"><rect x="499" y="511" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 541px; margin-left: 500px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Token<br />head</div></div></div></foreignObject><text x="559" y="545" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Token...</text></switch></g></g></g><g data-cell-id="klyqtZBdWCXgg6U5yR7y-19"><g transform="translate(0.5,0.5)"><path d="M 775 541 L 795.52 541.03 L 795.52 509.03 L 809.63 509.01" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 814.88 509 L 807.89 512.51 L 809.63 509.01 L 807.88 505.51 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="U0eDsRkNowskEU1cyVyJ-1"><g transform="translate(0.5,0.5)"><rect x="189" y="457.5" width="291.5" height="76" rx="11.4" ry="11.4" fill-opacity="0.57" fill="#ffffff" stroke="#660000" stroke-dasharray="3 3" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(102, 0, 0), rgb(255, 200, 200));"/></g></g><g data-cell-id="klyqtZBdWCXgg6U5yR7y-9"><g transform="translate(0.5,0.5)"><rect x="655" y="511" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 541px; margin-left: 656px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Mean<br />token score</div></div></div></foreignObject><text x="715" y="545" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Mean...</text></switch></g></g></g><g data-cell-id="klyqtZBdWCXgg6U5yR7y-10"><g transform="translate(0.5,0.5)"><rect x="816" y="464" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 494px; margin-left: 817px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Global score</div></div></div></foreignObject><text x="876" y="498" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Global score</text></switch></g></g></g><g data-cell-id="ZrHKWYk25MqRuA0MvCR7-11"><g transform="translate(0.5,0.5)"><rect x="348" y="464" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 494px; margin-left: 349px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Cross-attention</div></div></div></foreignObject><text x="408" y="498" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Cross-attention</text></switch></g></g></g><g data-cell-id="klyqtZBdWCXgg6U5yR7y-2"><g transform="translate(0.5,0.5)"><rect x="201" y="464" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 494px; margin-left: 202px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Encoder</div></div></div></foreignObject><text x="261" y="498" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Encoder</text></switch></g></g></g><g data-cell-id="klyqtZBdWCXgg6U5yR7y-11"><g transform="translate(0.5,0.5)"><path d="M 261 464 L 261.03 444 L 408 444 L 408 457.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 408 462.88 L 404.5 455.88 L 408 457.63 L 411.5 455.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="klyqtZBdWCXgg6U5yR7y-12"><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 443px; margin-left: 334px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">Prime context</div></div></div></foreignObject><text x="334" y="447" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px" text-anchor="middle">Prime context</text></switch></g></g></g></g><g data-cell-id="klyqtZBdWCXgg6U5yR7y-13"><g transform="translate(0.5,0.5)"><path d="M 261 524 L 261.03 548 L 408 548 L 408 530.37" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 408 525.12 L 411.5 532.12 L 408 530.37 L 404.5 532.12 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="klyqtZBdWCXgg6U5yR7y-14"><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 551px; margin-left: 335px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">Continuation<br />embedding</div></div></div></foreignObject><text x="335" y="555" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px" text-anchor="middle">Continuation...</text></switch></g></g></g></g><g data-cell-id="klyqtZBdWCXgg6U5yR7y-17"><g transform="translate(0.5,0.5)"><path d="M 619 541 L 648.63 541" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 653.88 541 L 646.88 544.5 L 648.63 541 L 646.88 537.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="klyqtZBdWCXgg6U5yR7y-15"><g transform="translate(0.5,0.5)"><path d="M 438 464 L 438 444 L 492.63 444" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 497.88 444 L 490.88 447.5 L 492.63 444 L 490.88 440.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="klyqtZBdWCXgg6U5yR7y-16"><g transform="translate(0.5,0.5)"><path d="M 438 524 L 438 541.03 L 492.63 541" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 497.88 541 L 490.88 544.5 L 492.63 541 L 490.88 537.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g></g><g data-cell-id="9BSo3wNhfy6OWNm6dqiN-3"><g transform="translate(0.5,0.5)"><rect x="8" y="381" width="113" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 111px; height: 1px; padding-top: 396px; margin-left: 9px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #ababab; background-color: #ffffff; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: light-dark(#ababab, #ffc8c8); line-height: 1.2; pointer-events: all; font-weight: bold; background-color: light-dark(#ffffff, #ededed); white-space: normal; word-wrap: normal; "><font style="font-size: 16px;">Batch</font></div></div></div></foreignObject><text x="65" y="400" fill="light-dark(#ababab, #ffc8c8)" font-family="Helvetica" font-size="14px" text-anchor="middle" font-weight="bold">Batch</text></switch></g></g></g></g></g></g></svg>